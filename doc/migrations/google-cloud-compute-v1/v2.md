# Migration Guide

Crate: `google-cloud-compute-v1`

Versions: `v1.x` -> `v2.x`

## What Changed?

Builders and stubs that returned a `wkt::Empty` now return the unit type `()`.

The affected RPCs are:

- `google.cloud.compute.v1.BackendServices::get_effective_security_policies`
- `google.cloud.compute.v1.GlobalOperations::delete`
- `google.cloud.compute.v1.GlobalOrganizationOperations::delete`
- `google.cloud.compute.v1.Instant::send_diagnostic_interrupt`
- `google.cloud.compute.v1.RegionOperations::delete`
- `google.cloud.compute.v1.ZoneOperations::delete`

## How to migrate

If your code named this type, you will need to replace `wkt::Empty` with `()`.

For example, this code...

```rust
use google_cloud_compute_v1 as gce;
use gce::model::global_operations::DeleteRequest;
use google_cloud_gax::options::RequestOptions;
use google_cloud_gax::response::Response;
use google_cloud_wkt as wkt;

impl gce::stub::GlobalOperations for MyGlobalOperations {
  async fn delete(&self, _r: DeleteRequest, _o: RequestOptions)
      -> gce::Result<Response<wkt::Empty>> { ... }
}
```

Needs to become (omitting the `use` declarations):

```rust
impl gce::stub::GlobalOperations for MyGlobalOperations {
  async fn delete(&self, _r: DeleteRequest, _o: RequestOptions)
      -> gce::Result<Response<()>> { ... }
}
```

## Why we made the break

In all other crates, we convert a return type of `google.protobuf.Empty` to `()`
beneath the API surface, because `()` is more familiar to Rust developers. We
simply missed this conversion in our GCE library.

We do not take breaks lightly. We felt it was worth it to make the break and
bump the crate version instead of maintaining the less-than-ideal API because:

- The likelihood of customer impact is almost 0.
  - The `v1.x`crate has been GA for less than a month.
  - The `delete` operations are covered by LROs.
- The migration is a simple rename.
