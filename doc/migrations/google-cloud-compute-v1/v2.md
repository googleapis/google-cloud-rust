# Migration Guide

Crate: `google-cloud-compute-v1`

Versions: `v1.x` -> `v2.x`

## What Changed?

Builders and stubs that returned a `wkt::Empty` now return the unit type `()`.

The affected RPCs are:

- `BackendServices::get_effective_security_policies`
- `GlobalOperations::delete`
- `GlobalOrganizationOperations::delete`
- `Instances::send_diagnostic_interrupt`
- `RegionOperations::delete`
- `ZoneOperations::delete`

## How to migrate

If your code named this type, you will need to replace `wkt::Empty` with `()`.

For example, this code...

```rust
use google_cloud_compute_v1::client::GlobalOperations;
use google_cloud_wkt as wkt;

async fn delete(client: &GlobalOperations, name: &str) -> anyhow::Result<()> {
    let delete: wkt::Empty = client.delete().set_name(name).send().await?;
    println!("delete = {delete:?}");
    Ok(())
}
```

... needs to become (omitting the `use` declarations):

```rust
async fn delete(client: &GlobalOperations, name: &str) -> anyhow::Result<()> {
    client.delete().set_name(name).send().await?;
    println!("successful delete of {name}");
    Ok(())
}
```

## Why we made the break

In all other crates, we convert a return type of `google.protobuf.Empty` to `()`
beneath the API surface, because `()` is more familiar to Rust developers. We
simply missed this conversion in our Google Compute Engine library.

We do not take breaks lightly. We felt it was worth it to make the break and
bump the crate version instead of maintaining the less-than-ideal API because:

- The likelihood of customer impact is very low.
  - The `v1.0.0`crate has been GA for less than a month.
  - The RPCs that change are rarely used.
- The migration is a simple rename.
